<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>お問い合わせ | Speedix LP</title>
  <link rel="icon" type="image/png" href="../images/img_logo_black.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css?v=0.1.0">
</head>
<body>
  <script>
    // フィールド名を日本語に変換するマッピング
    var fieldNameMap = {
      'name': 'お名前',
      'furigana': 'ふりがな',
      'company': '会社名',
      'email': 'メールアドレス',
      'phone': '電話番号',
      'type': '種別',
      'plan': 'プラン',
      'message': 'お問い合わせ内容',
      'privacy': 'プライバシーポリシー'
    };
    
    // エラーメッセージを取得
    var errorMessages = [];
    {if:$global_errors}
    {loop:$global_errors}
    errorMessages.push('{$global_errors[]}');
    {/loop:$global_errors}
    {/if:$global_errors}
    
    // フィールド名を日本語に変換
    var translatedMessages = errorMessages.map(function(msg) {
      for (var fieldName in fieldNameMap) {
        if (msg.indexOf(fieldName) === 0) {
          return msg.replace(fieldName, fieldNameMap[fieldName]);
        }
      }
      return msg;
    });
    
    // デバッグ用
    console.log('Error messages:', errorMessages);
    console.log('Translated messages:', translatedMessages);
    
    // エラーメッセージをURLパラメータにエンコードしてフォームページにリダイレクト
    if (translatedMessages.length > 0) {
      var errorMessage = translatedMessages.join('\\n');
      console.log('Redirecting with error:', errorMessage);
      var redirectUrl = '../?error=1&message=' + encodeURIComponent(errorMessage) + '#contact';
      window.location.href = redirectUrl;
    } else {
      console.log('No errors, redirecting to form');
      window.location.href = '../#contact';
    }
  </script>
  <p>リダイレクト中...</p>
</body>
</html>

